<process xmlns="http://schemas.active-endpoints.com/appmodules/screenflow/2010/10/avosScreenflow.xsd" xmlns:types1="http://schemas.active-endpoints.com/appmodules/repository/2010/10/avrepository.xsd" xmlns:aetgt="http://schemas.active-endpoints.com/appmodules/repository/2010/10/avrepository.xsd" xmlns:list="urn:activevos:spi:list:functions" name="proc-FRA-Lander-bmm-subProcess"><appliesTo/><description>SubProcess STEP 1 (to n) for Loading of data, can be done in one step, but for the first BM system,demonstrating multiple steps for the flow for other systems</description><tags>.agent:icopal_dev</tags><generator>Informatica Process Designer 8</generator><input><parameter name="fromMaster_ProcessID" type="string"><options><option name="required">false</option></options></parameter><parameter name="fromMaster_processName" type="string"><options><option name="required">false</option></options></parameter><parameter name="fromMaster_DataSourceKey" type="string"><options><option name="required">false</option></options></parameter><parameter name="fromMaster_SubProcessName" type="string"><options><option name="required">false</option></options></parameter></input><tempFields><field name="tmp_EndState" type="string"><options><option name="required">false</option></options></field><field name="tmp_EndMessage" type="string"><options><option name="required">false</option></options></field></tempFields><notes/><deployment suspendOnFault="false" tracingLevel="verbose"><targetLocation>icopal_dev</targetLocation><rest/></deployment><flow id="a"><start id="b"><link id="j66h8h2g" targetId="j66h8h2f"/></start><assignment id="j66h8h2f"><title>Assignment of fromMaster_DataSourceKey</title><operation source="formula" to="input.fromMaster_DataSourceKey"><expression language="XQuery">if(fn:string-length($input.fromMaster_DataSourceKey)=0) then 
(
'1001150000'
) else (
$input.fromMaster_DataSourceKey
)</expression></operation><operation source="formula" to="input.fromMaster_ProcessID"><expression language="XQuery">if(fn:string-length($input.fromMaster_ProcessID)=0) then 
(
'99999'
) else (
$input.fromMaster_ProcessID
)</expression></operation><operation source="formula" to="input.fromMaster_processName"><expression language="XQuery">if(fn:string-length($input.fromMaster_processName)=0) then 
(
'FRA-M3-TEST'
) else (
$input.fromMaster_processName
)</expression></operation><operation source="formula" to="input.fromMaster_SubProcessName"><expression language="XQuery">if(fn:string-length($input.fromMaster_SubProcessName)=0) then 
(
'FRA-M3-TEST-LOAD'
) else (
$input.fromMaster_SubProcessName
)</expression></operation><link id="j66h8h2h" targetId="j5p0nr2r"/></assignment><assignment id="j66ksif7"><title>Fabricate the EndState and EndMessage</title><operation source="formula" to="temp.tmp_EndState"><expression language="XQuery">if($output.output_ActualThreadCount &lt; $output.output_ExpectedThreadCount) then 
(
'Some threads failed'
) else (
'All Threads run successfully'
)

</expression></operation><operation source="formula" to="temp.tmp_EndMessage"><expression language="XQuery">if($output.output_ActualThreadCount &lt; $output.output_ExpectedThreadCount) then 
(
'[Error] Somewhere'
) else (
'[Sub Process completed successfully, All Threads run successfully]'
)</expression></operation><link id="j66ksif9" targetId="j5p7infq"/></assignment><service id="j5p0nr2r"><title>SubProcess START</title><serviceName>Conn-WS-StoredProcs:mplt_StartRun_Operation</serviceName><serviceInput><parameter name="ProcessName" source="field" updatable="true">input.fromMaster_processName</parameter><parameter name="IcrtProcessId" source="field" updatable="true">input.fromMaster_ProcessID</parameter><parameter name="SubProcessName" source="field" updatable="true">input.fromMaster_SubProcessName</parameter><parameter name="MappingConfigTaskName" source="constant">''</parameter><parameter name="MappingName" source="constant">''</parameter></serviceInput><link id="j5tprlwz" targetId="j5tprlvl"/></service><service id="j65pkfiw"><title>SubProcess CHECK THREADS</title><serviceName>Conn-WS-StoredProcs:mplt_SubProcessCheckThreads_Operation</serviceName><serviceInput><parameter name="SubProcessName" source="field" updatable="true">input.fromMaster_SubProcessName</parameter><parameter name="SubProcessRunId" source="field" updatable="true">output.output_SubProcessRunId</parameter></serviceInput><link id="j66ksif8" targetId="j66ksif7"/></service><service id="j5p7infq"><title>SubProcess STOP</title><serviceName>Conn-WS-StoredProcs:mplt_StopRun_Operation</serviceName><serviceInput><parameter name="ProcessName" source="field" updatable="true">input.fromMaster_processName</parameter><parameter name="IcrtProcessId" source="field" updatable="true">input.fromMaster_ProcessID</parameter><parameter name="EndState" source="field" updatable="true">temp.tmp_EndState</parameter><parameter name="EndMessage" source="field" updatable="true">temp.tmp_EndMessage</parameter><parameter name="SubProcessName" source="field" updatable="true">input.fromMaster_SubProcessName</parameter><parameter name="SubProcessRunId" source="field" updatable="true">output.output_SubProcessRunId</parameter></serviceInput><link id="j5p7infs" targetId="d"/></service><subflow id="j5tprlvl"><title>Run Thread: FRA CMNDIV</title><subflowPath>proc-FRA-Lander-bmm-thread</subflowPath><runForEach>false</runForEach><input><parameter name="fromSub_ProcessID" source="field" updatable="true">input.fromMaster_ProcessID</parameter><parameter name="fromSub_ProcessName" source="field" updatable="true">input.fromMaster_processName</parameter><parameter name="fromSub_DataSourceKey" source="field" updatable="true">input.fromMaster_DataSourceKey</parameter><parameter name="fromSub_SubProcessName" source="field" updatable="true">input.fromMaster_SubProcessName</parameter><parameter name="fromSub_MappingConfigTaskName" source="constant" updatable="true">mct_m3v7toSQLDB_FRA_single_CMNDIV</parameter><parameter name="fromSub_MappingName" source="constant" updatable="true">m_sourceToSQLDB_singleTable_prod</parameter></input><outputDef/><link id="j67vk2wi" targetId="j5tprlu7"/></subflow><subflow id="j5tprlu7"><title>Run Thread: FRA MITMAS</title><subflowPath>proc-FRA-Lander-bmm-thread</subflowPath><runForEach>false</runForEach><input><parameter name="fromSub_ProcessID" source="field" updatable="true">input.fromMaster_ProcessID</parameter><parameter name="fromSub_ProcessName" source="field" updatable="true">input.fromMaster_processName</parameter><parameter name="fromSub_DataSourceKey" source="field" updatable="true">input.fromMaster_DataSourceKey</parameter><parameter name="fromSub_SubProcessName" source="field" updatable="true">input.fromMaster_SubProcessName</parameter><parameter name="fromSub_MappingConfigTaskName" source="constant" updatable="true">mct_m3v7toSQLDB_FRA_single_MITMAS</parameter><parameter name="fromSub_MappingName" source="constant" updatable="true">m_sourceToSQLDB_singleTable_prod</parameter></input><outputDef/><link id="j65pkfix" targetId="j65pkfiw"/></subflow><end id="d"/></flow></process>