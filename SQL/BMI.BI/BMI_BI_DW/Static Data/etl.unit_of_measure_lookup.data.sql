--MERGE generated by 'sp_generate_merge' stored procedure, Version 0.93
--Originally by Vyas (http://vyaskn.tripod.com): sp_generate_inserts (build 22)
--Adapted for SQL Server 2008/2012 by Daniel Nolan (http://danere.com)

set nocount on

merge into [etl].[unit_of_measure_lookup] as Target
using (values
  (100101,'B1','',44)
 ,(100101,'BAG','',45)
 ,(100101,'BD','',46)
 ,(100101,'BKT','',49)
 ,(100101,'BND','',46)
 ,(100101,'BOX','',47)
 ,(100101,'BT','',49)
 ,(100101,'BU','',49)
 ,(100101,'BX','',47)
 ,(100101,'CN','',49)
 ,(100101,'CRT','',48)
 ,(100101,'CT','',48)
 ,(100101,'EA','',49)
 ,(100101,'HR','',49)
 ,(100101,'HUR','',49)
 ,(100101,'KAN','',49)
 ,(100101,'KAR','',49)
 ,(100101,'KG','',41)
 ,(100101,'KI','',49)
 ,(100101,'KIT','',49)
 ,(100101,'KPL','',49)
 ,(100101,'KPL.','',49)
 ,(100101,'KT','',49)
 ,(100101,'Kg','',41)
 ,(100101,'L','',51)
 ,(100101,'LITER','',51)
 ,(100101,'LITRO','',51)
 ,(100101,'LM','',33)
 ,(100101,'LT','',41)
 ,(100101,'LTR','',41)
 ,(100101,'M','',33)
 ,(100101,'M.LINEAL','',33)
 ,(100101,'M1','',33)
 ,(100101,'M2','',15)
 ,(100101,'M3','',24)
 ,(100101,'METER','',33)
 ,(100101,'MTR','',33)
 ,(100101,'M²','',15)
 ,(100101,'M³','',24)
 ,(100101,'OPK','',48)
 ,(100101,'OPK.','',48)
 ,(100101,'PAK','',48)
 ,(100101,'PAL','',52)
 ,(100101,'PCE','',49)
 ,(100101,'PCS','',49)
 ,(100101,'PCZ','',49)
 ,(100101,'PK','',48)
 ,(100101,'PKT','',49)
 ,(100101,'PL','',49)
 ,(100101,'PLT','',52)
 ,(100101,'RL','',53)
 ,(100101,'RLE','',53)
 ,(100101,'RLL','',53)
 ,(100101,'ROL','',53)
 ,(100101,'RUL','',53)
 ,(100101,'SAC','',45)
 ,(100101,'SET','',47)
 ,(100101,'SHT','',49)
 ,(100101,'SP','',49)
 ,(100101,'ST','',49)
 ,(100101,'STK','',49)
 ,(100101,'SZT','',49)
 ,(100101,'SZT.','',49)
 ,(100101,'SÆT','',47)
 ,(100101,'TB','',49)
 ,(100101,'TUB','',49)
 ,(100101,'UN','',49)
 ,(100101,'UNI','',49)
 ,(100101,'UNIT','',49)
 ,(100101,'kg','',41)
 ,(100101,'l','',51)
 ,(100101,'m','',33)
 ,(100101,'m2','',15)
 ,(100101,'m3','',24)
 ,(100101,'m²','',15)
 ,(100101,'m³','',24)
 ,(100101,'szt','',49)
 ,(100101,'szt.','',49)
 ,(100113,'B1','',44)
 ,(100113,'BAG','',45)
 ,(100113,'BD','',49)
 ,(100113,'BKT','',49)
 ,(100113,'BND','',46)
 ,(100113,'BOX','',47)
 ,(100113,'BT','',49)
 ,(100113,'BU','',49)
 ,(100113,'BX','',47)
 ,(100113,'CN','',49)
 ,(100113,'CRT','',48)
 ,(100113,'CT','',48)
 ,(100113,'EA','',49)
 ,(100113,'HR','',49)
 ,(100113,'HUR','',49)
 ,(100113,'KAN','',49)
 ,(100113,'KAR','',49)
 ,(100113,'KG','',41)
 ,(100113,'KI','',49)
 ,(100113,'KIT','',49)
 ,(100113,'KPL','',49)
 ,(100113,'KPL.','',49)
 ,(100113,'KT','',49)
 ,(100113,'L','',51)
 ,(100113,'LITER','',51)
 ,(100113,'LITRO','',51)
 ,(100113,'LM','',33)
 ,(100113,'LT','',51)
 ,(100113,'LTR','',51)
 ,(100113,'M','',33)
 ,(100113,'M.LINEAL','',33)
 ,(100113,'M1','',33)
 ,(100113,'M2','',15)
 ,(100113,'M3','',24)
 ,(100113,'METER','',33)
 ,(100113,'MTR','',33)
 ,(100113,'M²','',15)
 ,(100113,'M³','',24)
 ,(100113,'OPK','',48)
 ,(100113,'OPK.','',48)
 ,(100113,'PAK','',48)
 ,(100113,'PAL','',52)
 ,(100113,'PCE','',49)
 ,(100113,'PCS','',49)
 ,(100113,'PCZ','',49)
 ,(100113,'PK','',48)
 ,(100113,'PKT','',49)
 ,(100113,'PL','',49)
 ,(100113,'PLT','',52)
 ,(100113,'RL','',53)
 ,(100113,'RLE','',53)
 ,(100113,'RLL','',53)
 ,(100113,'ROL','',53)
 ,(100113,'RUL','',53)
 ,(100113,'SAC','',45)
 ,(100113,'SET','',47)
 ,(100113,'SHT','',49)
 ,(100113,'SP','',49)
 ,(100113,'ST','',49)
 ,(100113,'STK','',49)
 ,(100113,'SZT','',49)
 ,(100113,'SZT.','',49)
 ,(100113,'SÆT','',47)
 ,(100113,'TB','',49)
 ,(100113,'TUB','',49)
 ,(100113,'UN','',49)
 ,(100113,'UNI','',49)
 ,(100113,'UNIT','',49)
 ,(100113,'kg','',41)
 ,(100113,'l','',51)
 ,(100113,'m','',15)
 ,(100113,'m2','',15)
 ,(100113,'m3','',24)
 ,(100113,'m²','',15)
 ,(100113,'m³','',24)
 ,(100113,'opk','',48)
 ,(100113,'opk.','',48)
 ,(100113,'szt','',49)
 ,(100113,'szt.','',49)
 ,(100140,'B1','',44)
 ,(100140,'BAG','',45)
 ,(100140,'BD','',46)
 ,(100140,'BKT','',49)
 ,(100140,'BND','',46)
 ,(100140,'BOX','',47)
 ,(100140,'BT','',49)
 ,(100140,'BU','',49)
 ,(100140,'BX','',47)
 ,(100140,'CN','',49)
 ,(100140,'CRT','',48)
 ,(100140,'CT','',48)
 ,(100140,'EA','',49)
 ,(100140,'HR','',49)
 ,(100140,'HUR','',49)
 ,(100140,'KAN','',49)
 ,(100140,'KAR','',49)
 ,(100140,'KG','',41)
 ,(100140,'KI','',49)
 ,(100140,'KIT','',49)
 ,(100140,'KPL','',49)
 ,(100140,'KPL.','',49)
 ,(100140,'KT','',49)
 ,(100140,'Kg','',41)
 ,(100140,'L','',51)
 ,(100140,'LITER','',51)
 ,(100140,'LITRO','',51)
 ,(100140,'LM','',33)
 ,(100140,'LT','',51)
 ,(100140,'LTR','',51)
 ,(100140,'M','',33)
 ,(100140,'M.LINEAL','',33)
 ,(100140,'M1','',33)
 ,(100140,'M2','',15)
 ,(100140,'M3','',24)
 ,(100140,'METER','',33)
 ,(100140,'MTR','',33)
 ,(100140,'M²','',15)
 ,(100140,'M³','',24)
 ,(100140,'OPK','',48)
 ,(100140,'OPK.','',48)
 ,(100140,'PAK','',48)
 ,(100140,'PAL','',52)
 ,(100140,'PCE','',49)
 ,(100140,'PCS','',49)
 ,(100140,'PCZ','',49)
 ,(100140,'PK','',48)
 ,(100140,'PKT','',49)
 ,(100140,'PL','',49)
 ,(100140,'PLT','',52)
 ,(100140,'RL','',53)
 ,(100140,'RLE','',53)
 ,(100140,'RLL','',53)
 ,(100140,'ROL','',53)
 ,(100140,'RUL','',53)
 ,(100140,'SAC','',45)
 ,(100140,'SET','',47)
 ,(100140,'SHT','',49)
 ,(100140,'SP','',49)
 ,(100140,'ST','',49)
 ,(100140,'STK','',49)
 ,(100140,'SZT','',49)
 ,(100140,'SZT.','',49)
 ,(100140,'SÆT','',47)
 ,(100140,'TB','',49)
 ,(100140,'TUB','',49)
 ,(100140,'UN','',49)
 ,(100140,'UNI','',49)
 ,(100140,'UNIT','',49)
 ,(100140,'kg','',41)
 ,(100140,'l','',51)
 ,(100140,'m','',33)
 ,(100140,'m2','',15)
 ,(100140,'m3','',24)
 ,(100140,'m²','',15)
 ,(100140,'m³','',24)
 ,(100140,'opk','',48)
 ,(100140,'opk.','',48)
 ,(100140,'szt','',49)
 ,(100140,'szt.','',49)
 ,(100141,'B1','',44)
 ,(100141,'BAG','',45)
 ,(100141,'BD','',46)
 ,(100141,'BKT','',49)
 ,(100141,'BND','',46)
 ,(100141,'BOX','',47)
 ,(100141,'BT','',49)
 ,(100141,'BU','',49)
 ,(100141,'BX','',47)
 ,(100141,'CN','',49)
 ,(100141,'CRT','',48)
 ,(100141,'CT','',48)
 ,(100141,'EA','',49)
 ,(100141,'HR','',49)
 ,(100141,'HUR','',49)
 ,(100141,'KAN','',49)
 ,(100141,'KAR','',49)
 ,(100141,'KG','',41)
 ,(100141,'KI','',49)
 ,(100141,'KIT','',49)
 ,(100141,'KPL','',49)
 ,(100141,'KPL.','',49)
 ,(100141,'KT','',49)
 ,(100141,'Kg','',41)
 ,(100141,'L','',51)
 ,(100141,'LITER','',51)
 ,(100141,'LITRO','',51)
 ,(100141,'LM','',33)
 ,(100141,'LT','',51)
 ,(100141,'LTR','',51)
 ,(100141,'M','',33)
 ,(100141,'M.LINEAL','',33)
 ,(100141,'M1','',33)
 ,(100141,'M2','',15)
 ,(100141,'M3','',24)
 ,(100141,'METER','',33)
 ,(100141,'MTR','',33)
 ,(100141,'M²','',15)
 ,(100141,'M³','',24)
 ,(100141,'OPK','',48)
 ,(100141,'OPK.','',48)
 ,(100141,'PAK','',48)
 ,(100141,'PAL','',52)
 ,(100141,'PCE','',49)
 ,(100141,'PCS','',49)
 ,(100141,'PCZ','',49)
 ,(100141,'PK','',48)
 ,(100141,'PKT','',49)
 ,(100141,'PL','',49)
 ,(100141,'PLT','',52)
 ,(100141,'RL','',53)
 ,(100141,'RLE','',53)
 ,(100141,'RLL','',53)
 ,(100141,'ROL','',53)
 ,(100141,'RUL','',53)
 ,(100141,'SAC','',45)
 ,(100141,'SET','',47)
 ,(100141,'SHT','',49)
 ,(100141,'SP','',49)
 ,(100141,'ST','',49)
 ,(100141,'STK','',49)
 ,(100141,'SZT','',49)
 ,(100141,'SZT.','',49)
 ,(100141,'SÆT','',47)
 ,(100141,'TB','',49)
 ,(100141,'TUB','',49)
 ,(100141,'UN','',49)
 ,(100141,'UNI','',49)
 ,(100141,'UNIT','',49)
 ,(100141,'kg','',41)
 ,(100141,'l','',51)
 ,(100141,'m','',33)
 ,(100141,'m2','',15)
 ,(100141,'m3','',24)
 ,(100141,'m²','',15)
 ,(100141,'m³','',24)
 ,(100141,'opk','',48)
 ,(100141,'opk.','',48)
 ,(100141,'szt','',49)
 ,(100141,'szt.','',49)
) as Source ([data_source_key],[native_key],[native_value],[unit_of_measure_id])
on (Target.[data_source_key] = Source.[data_source_key] and Target.[native_key] = Source.[native_key])
when matched and (
	nullif(Source.[native_value], Target.[native_value]) is not null or nullif(Target.[native_value], Source.[native_value]) is not null or 
	nullif(Source.[unit_of_measure_id], Target.[unit_of_measure_id]) is not null or nullif(Target.[unit_of_measure_id], Source.[unit_of_measure_id]) is not null) then
 update set
  [native_value] = Source.[native_value], 
  [unit_of_measure_id] = Source.[unit_of_measure_id]
when not matched by target then
 insert([data_source_key],[native_key],[native_value],[unit_of_measure_id])
 values(Source.[data_source_key],Source.[native_key],Source.[native_value],Source.[unit_of_measure_id])
when not matched by source then 
 delete
;
go
declare @mergeError int
 , @mergeCount int
select @mergeError = @@error, @mergeCount = @@rowcount
if @mergeError != 0
 begin
 print 'ERROR OCCURRED IN MERGE FOR [etl].[unit_of_measure_lookup]. Rows affected: ' + cast(@mergeCount as varchar(100)); -- SQL should always return zero rows affected
 end
else
 begin
 print '[etl].[unit_of_measure_lookup] rows affected by MERGE: ' + cast(@mergeCount as varchar(100));
 end
go

set nocount off
go
